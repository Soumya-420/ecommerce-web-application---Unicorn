<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="E-Commerce Store - All Products">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>All Products - Unicorn Online Shopping</title>
    <link rel="stylesheet" href="css/theme.css">
    <script type="module" src="js/theme.js"></script>
    <link rel="stylesheet" href="css/responsive.css">
    <link rel="manifest" href="manifest.json">

    <style>
        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 2rem;
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 4px 15px var(--card-shadow);
        }

        .page-title {
            color: var(--text-color);
        }

        .product-card {
            background: var(--card-bg);
            box-shadow: 0 4px 10px var(--card-shadow);
            color: var(--text-color);
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 2.5rem;
            padding: 2rem 0;
        }

        .product-card {
            background: var(--card-bg);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 20px var(--card-shadow);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            flex-direction: column;
            color: var(--text-color);
        }

        .product-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px var(--card-shadow);
        }

        .product-image-link {
            display: block;
            height: 280px;
            overflow: hidden;
        }

        .product-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .product-card:hover .product-image {
            transform: scale(1.1);
        }

        .product-info {
            padding: 1.5rem;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .product-name {
            font-size: 1.25rem;
            margin-bottom: .5rem;
            color: var(--text-color);
            text-decoration: none;
        }

        .product-price {
            font-size: 1.4rem;
            color: #e74c3c;
            margin-bottom: 1rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .original-price {
            text-decoration: line-through;
            color: #95a5a6;
            font-size: 0.9rem;
            font-weight: 400;
        }

        .discount-badge {
            background: #27ae60;
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .view-details-btn {
            width: 100%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: #fff !important;
            border: none;
            padding: .85rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            text-align: center;
            text-decoration: none;
            transition: opacity 0.3s;
        }

        /* Profile Dropdown Override */
        body.dark-mode #profile-dropdown a {
            color: #ecf0f1 !important;
            background: #2c3e50 !important;
        }

        body.dark-mode #profile-dropdown a:hover {
            background: #34495e !important;
        }
    </style>
</head>

<body>
    <header>
        <nav>
            <div style="display: flex; align-items: center; gap: 1rem;">
                <div class="logo brand-logo" onclick="location.href='index.html'">
                    <span>ðŸ¦„</span> Unicorn
                </div>
                <div id="welcome-msg" class="welcome-text" style="display: none;"></div>
            </div>

            <button class="hamburger" onclick="toggleMobileMenu()">â˜°</button>
            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="product.html">Products</a></li>
                <li id="cart-link" class="cart-icon">
                    <a href="cart.html" style="padding: 0; background: none; border: none; box-shadow: none;">
                        <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"
                            viewBox="0 0 24 24">
                            <circle cx="9" cy="21" r="1" />
                            <circle cx="20" cy="21" r="1" />
                            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6" />
                        </svg>
                        Cart
                        <span class="cart-count" id="cart-count">0</span>
                    </a>
                </li>
                <!-- Profile Dropdown -->
                <li id="profile-menu" style="position: relative; display: block;">
                    <button onclick="toggleProfileMenu()" id="profile-btn">
                        <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"
                            viewBox="0 0 24 24">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                            <circle cx="12" cy="7" r="4" />
                        </svg>
                        Profile
                    </button>
                    <div id="profile-dropdown"
                        style="display: none; position: absolute; right: 0; top: 100%; min-width: 200px; border-radius: 5px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); overflow: hidden; margin-top: 10px; z-index: 1001; background: var(--card-bg);">
                        <a href="profile.html"
                            style="display: block; padding: 12px 15px; color: var(--text-color); text-decoration: none; border-bottom: 1px solid var(--border-color);">Manage
                            Profile</a>
                        <a href="profile.html#orders-section"
                            style="display: block; padding: 12px 15px; color: var(--text-color); text-decoration: none; border-bottom: 1px solid var(--border-color);">Orders</a>

                        <a href="#" onclick="logout()"
                            style="display: block; padding: 12px 15px; color: #e74c3c; text-decoration: none;">Logout</a>
                    </div>
                </li>
                <li>
                    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle Day/Night Mode">
                        <span id="theme-icon">ðŸŒ™</span>
                    </button>
                </li>
            </ul>
        </nav>
    </header>

    <div class="container">
        <header class="page-header">
            <h1 class="page-title">Explore Our Collection</h1>
            <p>Quality products curated just for you</p>
        </header>

        <div class="products-grid" id="products-grid">
            <!-- Products will be injected here -->
        </div>
    </div>

    <footer>
        <p>&copy; 2025 Unicorn Store. All rights reserved.</p>
    </footer>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyD1ccRiAIz_MYh6lv3u-gliWtHSBqS3zQs",
            authDomain: "ecommerce-3a30f.firebaseapp.com",
            projectId: "ecommerce-3a30f",
            storageBucket: "ecommerce-3a30f.firebasestorage.app",
            messagingSenderId: "526024768102",
            appId: "1:526024768102:web:d408b83d034e8d912a4ba7",
            measurementId: "G-5HNQGF9L4H"
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();

        auth.onAuthStateChanged((user) => {
            const welcomeMsg = document.getElementById('welcome-msg');
            const profileMenu = document.getElementById('profile-menu');
            const navLinks = document.querySelector('.nav-links');

            if (user) {
                const fullName = user.displayName || 'User';
                const shortName = fullName.split(' ')[0];
                if (welcomeMsg) {
                    welcomeMsg.innerHTML = `Hi, ${shortName} <span style="-webkit-text-fill-color: initial;">âœ¨</span>`;
                    welcomeMsg.style.display = 'block';
                }
                if (profileMenu) profileMenu.style.display = 'block';
                const loginItem = Array.from(navLinks.children).find(li => li.id === 'login-link');
                if (loginItem) loginItem.style.display = 'none';
            } else {
                if (welcomeMsg) welcomeMsg.style.display = 'none';
                if (profileMenu) profileMenu.style.display = 'none';
                let loginItem = Array.from(navLinks.children).find(li => li.id === 'login-link');
                if (!loginItem) {
                    const li = document.createElement('li');
                    li.id = 'login-link';
                    li.innerHTML = '<a href="auth.html">Login</a>';
                    navLinks.insertBefore(li, profileMenu);
                } else {
                    loginItem.style.display = 'block';
                }
            }
        });

        const products = [
            {
                id: 1,
                name: "Premium Wireless Headphones",
                price: 299.99,
                originalPrice: 399.99,
                description: "High-quality sound with noise cancellation",
                image: "./images/headphone.webp"
            },
            {
                id: 2,
                name: "Smart Watch Pro",
                price: 399.99,
                originalPrice: 499.99,
                description: "Track your fitness and stay connected",
                image: "./images/smartwatch.webp"
            },
            {
                id: 3,
                name: "Wireless Earbuds",
                price: 149.99,
                originalPrice: 199.99,
                description: "Compact design with powerful sound",
                image: "./images/earbuds.webp"
            },
            {
                id: 4,
                name: "Laptop Stand",
                price: 49.99,
                originalPrice: 69.99,
                description: "Ergonomic design for better posture",
                image: "./images/laptop-stand.webp"
            },
            {
                id: 5,
                name: "USB-C Hub",
                price: 79.99,
                originalPrice: 99.99,
                description: "Connect all your devices with ease",
                image: "./images/usb-hub.webp"
            },
            {
                id: 6,
                name: "Mechanical Keyboard",
                price: 129.99,
                originalPrice: 169.99,
                description: "Premium typing experience",
                image: "./images/keyboard.webp"
            }
        ];

        const grid = document.getElementById("products-grid");

        function renderListing() {
            grid.innerHTML = products.map(p => {
                const discount = Math.round(((p.originalPrice - p.price) / p.originalPrice) * 100);
                return `
                    <div class="product-card">
                        <a href="product-detail.html?id=${p.id}" class="product-image-link">
                            <img src="${p.image}" alt="${p.name}" class="product-image" loading="lazy">
                        </a>
                        <div class="product-info">
                            <a href="product-detail.html?id=${p.id}" style="text-decoration: none;">
                                <h3 class="product-name">${p.name}</h3>
                            </a>
                            <div class="product-price">
                                $${p.price}
                                <span class="original-price">$${p.originalPrice}</span>
                                <span class="discount-badge">${discount}% OFF</span>
                            </div>
                            <p class="product-description">${p.description}</p>
                            <a href="product-detail.html?id=${p.id}" class="view-details-btn">View Details</a>
                        </div>
                    </div>
                `;
            }).join("");
        }

        // Firebase logic for navbar
        function toggleProfileMenu() {
            const dropdown = document.getElementById('profile-dropdown');
            dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';
        }

        function logout() {
            // Simplified for product listing page
            sessionStorage.removeItem('splashShown');
            window.location.href = 'index.html';
        }

        function updateCartCount() {
            const cart = JSON.parse(localStorage.getItem('cart') || '[]');
            const total = cart.reduce((sum, item) => sum + item.quantity, 0);
            const countEl = document.getElementById('cart-count');
            if (countEl) countEl.textContent = total;
        }

        updateCartCount();
        renderListing();
    </script>
</body>

</html>